
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Pay document</title>
    <script type="text/javascript" src="jquery-1.12.4.min.js" ></script>
    <script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.8.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<section style="background-color: #ece6cc">
    <div class="container" style="padding: 50px 0 50px 0;">
        <h1>I'mport; 결제 모듈 DEMO</h1>
        <div id="demo" class="col-md-8 col-md-offset-1 col-xs-11">
            <form name="frm_payment" id="frm_payment" class="form-horizontal">
                <div class="form-group" style="margin-bottom: 0px;">
                    <label for="pg_provider" class="col-md-4 col-xs-4">지원 PG사</label>
                    <select id="pg_provider" class="col-md-8 col-xs-8"><option label="NHN 한국사이버결제" value="kcp" selected="selected">NHN 한국사이버결제</option></select>
                </div>
                <div class="form-group">
                    <p id="pay_method_help" class="col-md-8 col-md-offset-4 col-xs-11 col-xs-offset-1 ">실제 승인이 이루어진 테스트 결제건은 약 30분 후 자동 취소처리됩니다.</p>
                </div>
                <div class="form-group" style="margin-bottom: 0px;">
                    <label for="pay_method" class="col-md-4 col-xs-4">결제수단</label>
                    <select id="pay_method" class="col-md-8 col-xs-8 "><option label="신용카드" value="card" selected="selected">신용카드</option></select>
                </div>
                <div class="form-group">
                    <div class="checkbox col-md-4 col-md-offset-3" style="padding: 0px;">
                        <label>
                            <input type="checkbox" name="use_escrow"  class="">
                            <span id="escrow-label"> 에스크로결제적용</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="merchant_uid" class="col-md-4 col-xs-4">주문번호</label>
                    <input type="text" name="merchant_uid" id="merchant_uid" value = "merchant_1580981850568" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="name" class="col-md-4 col-xs-4">결제명</label>
                    <input type="text" name="name" id="name" value="결제테스트" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="amount" class="col-md-4 col-xs-4">금액</label>
                    <input type="tel" name="amount" id="amount" value="1004" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="buyer_email" class="col-md-4 col-xs-4">이메일주소</label>
                    <input type="text" name="buyer_email" id="buyer_email" value="iamport@siot.do" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="buyer_name" class="col-md-4 col-xs-4">성함</label>
                    <input type="text" name="buyer_name" id="buyer_name" value="구매자" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="buyer_tel" class="col-md-4 col-xs-4">전화번호</label>
                    <input type="tel" name="buyer_tel" id="buyer_tel" value="010-1234-5678" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="buyer_addr" class="col-md-4 col-xs-4">주소</label>
                    <input type="text" name="buyer_addr" id="buyer_addr" value="서울특별시 강남구 삼성동" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="buyer_postcode" class="col-md-4 col-xs-4">우편번호</label>
                    <input type="text" name="buyer_postcode" id="buyer_postcode" value="123-456" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="vbank_due" class="col-md-4 col-xs-4">가상계좌 입금일자<br>(YYYYMMDD)</label>
                    <input type="text" name="vbank_due" id="vbank_due" value="20200208" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="vbank_appscheme" class="col-md-4 col-xs-4">앱스킴</label>
                    <input type="text" name="app_scheme" id="app_scheme" value="iamporttest" class="col-md-8 col-xs-8">
                </div>
                <div class="form-group">
                    <label for="vbank_m_redirect_url" class="col-md-4 col-xs-4">Redirect URL</label>
                    <input type="text" name="m_redirect_url" id="m_redirect_url" value="" class="col-md-8 col-xs-8" autocapitalize="off">
                </div>
                <div class="form-group">
                <label for="in_app" class="col-md-4 col-xs-4"></label>
                <label for="in_app" class="col-md-8 col-xs-8" style="text-align:left">
                    <input type="checkbox" name="in_app" value="in_app" class="">
                    <span> 앱내 webView를 통한 결제인 경우만 체크</span>
                </label>
                </div>
            </form>
            <a class="btn btn-primary" onclick="request_pay()">결제하기</a>
        </div>
    </div>
</section>
<body>
    <script type="text/javascript">
        
        var IMP = window.IMP; //자세한 사항은 https://docs.iamport.kr/implementation/payment 확인해주세요.
        IMP.init("imp40289144"); // Iamport dashboard의 고유 가맹점 식별코드입니다.
        
        function request_pay() {
            callFunc();
            IMP.request_pay(objectifyForm(frm_payment)),function(rsp){};
            
        }
        //form에서 입력받은 값을 JSON객체로 return합니다.
        function objectifyForm(formArray) {
            var returnArray = {};
            for (var i = 0; i < formArray.length; i++){
                returnArray[formArray[i]['name']] = formArray[i]['value'];
            }
            return returnArray;
        }
    
        //입력받은 myForm의 값을 WKWebView로 전달하기 위함.
        function callFunc() {
            window.webkit.messageHandlers.iamportTest.postMessage(objectifyForm(frm_payment));
        }
    
    </script>
 
</body>
</html>


